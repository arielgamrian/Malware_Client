#ifndef __PACKET__
#define __PACKET__

#include <stdlib.h>
#include <string.h>
#include <stdio.h>

#define PACKET_MAX_SIZE 255

typedef enum {
    PACKET_TYPE_NEED_ID = 1,
    PACKET_TYPE_ID = 2,
    PACKET_TYPE_ID_SUCCESS = 3,
    PACKET_TYPE_COMMAND = 4,
    PACKET_TYPE_COMMAND_RESPONSE = 5
} PACKET_TYPE;

typedef enum {
    COMMAND_TYPE_SHELL = 1,
    COMMAND_TYPE_SCREENSHOT = 2,
    COMMAND_TYPE_DOWNLOAD_FILE = 3
} COMMAND_TYPE;


typedef struct {
    PACKET_TYPE packet_type;
    int content_size;
    char content[0];
} packet;
    
typedef struct {
    int id;
} packet_content_id;

typedef struct {
    COMMAND_TYPE command_type;
    int args_length;
    char args[0];
} packet_content_command;

typedef struct {
    int length;
    char command[0];
} command_args_shell;

typedef struct {
    int length;
    char path[0];
} command_args_download_file;

typedef struct {
} command_args_screenshot;


char * packet_object_to_sendable(packet * packet_to_send);
packet * packet_sendable_to_object(char * packet_buffer);
packet * packet_new(PACKET_TYPE type, int content_size, void * content);
int packet_get_size(packet * packet);
packet * packet_from_buffer(char * buffer);

#endif // __PACKET__