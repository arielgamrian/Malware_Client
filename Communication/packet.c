#include "packet.h"

char * packet_object_to_sendable(packet * packet_to_send) {

    //int size = sizeof(packet) + packet_to_send->content_size - sizeof(packet_to_send->content);

    char * buffer = (char*) packet_to_send;

    memmove(&packet_to_send->content, packet_to_send->content, packet_to_send->content_size);
    return buffer;
}

packet * packet_sendable_to_object(char * packet_buffer) {

    packet * temp = (packet*) packet_buffer;
    int size = sizeof(packet) + temp->content_size;

    packet * packet_object = malloc(size);
    void * content_ptr = packet_object + 1;

    packet_object->packet_type = temp->packet_type;
    packet_object->content_size = temp->content_size;
    
    memmove(content_ptr, &temp->content, temp->content_size);

    packet_object->content = content_ptr;

    return packet_object;
}

void print_packet(char str[], packet * packet) {
    printf("on %s: packet_type = %d | content_size = %d\n", str, packet->packet_type, packet->content_size);
}