#include "linked_list.h"

bool add_node(linked_list * lst, void * value) {

    if (NULL == lst || NULL == value) {
        return false;
    }

    node * node_cursor = lst->head;
    node * new_node = (node *) malloc(sizeof(node) + sizeof(value));

    new_node->value = value; 
    
    if (NULL == lst->head) {
        lst->head = new_node;
        return true;
    }

    while (NULL != node_cursor->next) {
        node_cursor = node_cursor->next;
    }
    
    node_cursor->next = new_node;
    new_node->prev = node_cursor;

    return true;
}

bool remove_node(linked_list * lst, node * node_to_remove) {

    if (NULL == lst || NULL == node_to_remove) {
        return false;
    }

    if (!is_node_in_list(lst, node_to_remove)) {
        return false;
    }

    if (NULL == node_to_remove->prev) {
        lst->head = node_to_remove->next;
    }
    else {
        node_to_remove->prev->next = node_to_remove->next;
    }

    if (NULL == node_to_remove->next) {
        node_to_remove->prev = NULL;
    }
    else {
        node_to_remove->next->prev = node_to_remove->prev;
    }
    
    free(node_to_remove);

    return true;
}

int get_list_length(linked_list * lst) {

    int count;

    if (NULL == lst || NULL == lst->head) {
        return 0;
    }
    
    node * node_cursor = lst->head;
    count = 0;

    while (NULL != node_cursor)
    {
        count++;
        node_cursor = node_cursor->next;
    }
    return count;
}

void print_list(linked_list * lst) {

    if (NULL == lst) {
        return;
    }

    node * node_cursor = lst->head;

     while (NULL != node_cursor) {
        printf("%p->", node_cursor);
        node_cursor = node_cursor->next;
    }
    printf("\n");
}

bool is_node_in_list(linked_list* lst, node * n) {
    node * node_cursor = lst->head;
    if (node_cursor == n) {
        return true;
    }

    return false;
}